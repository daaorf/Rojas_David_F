######Gr치fica general######
ggplot(bd_prueba, aes(x = Tipo_de_Fuente, y = Emision, fill = Tipo_de_Fuente)) +
geom_boxplot() +
facet_wrap(~Contaminante, scales = "free_y") +
theme_minimal()
ggplot(PM_2_5, aes(x = Tipo_de_Fuente, y = Emision, fill = Tipo_de_Fuente)) +
geom_boxplot() +
theme_minimal() +
scale_x_discrete(labels = c(
"Fuentes de 치rea" = "FA",
"Fuentes fijas" = "FF",
"Fuentes m칩viles carreteros" = "FMC",
"Fuentes m칩viles que no circulan por carretera" = "FMNC",
"Fuentes naturales" = "FN")) +
labs(title = "Emisiones de PM2.5 por tipo de fuente",
y = "Emisi칩n",
x = "Tipo de fuente")
ggplot(bd_prueba, aes(x = Tipo_de_Fuente, y = Emision, fill = Tipo_de_Fuente)) +
geom_boxplot() +
facet_wrap(~Contaminante, scales = "free_y") +
theme_minimal() +
scale_x_discrete(labels = c(
"Fuentes de 치rea" = "FA",
"Fuentes fijas" = "FF",
"Fuentes m칩viles carreteros" = "FMC",
"Fuentes m칩viles que no circulan por carretera" = "FMNC",
"Fuentes naturales" = "FN"))
View(union2)
View(union1)
row.names(union1) <- union1$Entidad_federativa
dn <- union1[,-1]
pca <- prcomp(dn,scale. = TRUE)
row.names(cpf) <- cpf$Entidad_federativa
View(cm)
row.names(cm) <- cm$Entidad_federativa
row.names(co) <- co$Entidad_federativa
dn <- co[,-1]
pca <- prcomp(dn,scale. = TRUE)
summary(pca)
fviz_eig(pca, addlabels = TRUE)
######PCA##########
library(factoextra)
######PCA##########
library(factoextra)
summary(pca)
fviz_eig(pca, addlabels = TRUE)
fviz_pca_ind(pca,
geom.ind = "point",
col.ind = "cos2",
repel = TRUE)
fviz_pca_biplot(pca, repel = TRUE,
col.var = "red",
col.ind = "blue")
##########PCA####
#otras variables
row.names(cpf) <- cpf$Tipo_de_Fuente
##########PCA####
#otras variables
row.names(union1) <- union1$Tipo_de_Fuente
View(cpf)
View(union0)
View(union1)
# Cargar base de datos de muertes por cancer a nivel estatal en M칠xico, tomada de: Estad칤sticas de Defunciones Registradas (EDR) 2023 - INEGI
bd1 <- read_xlsx("muertes_cancer.xlsx")
library(tidyverse)
library(readxl)
library(sf)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(readxl)
library(sf)
library(ggplot2)
library(ggpubr)
#####Carga y modificaci칩n de las bases de datos#####
######Poblaci칩n######
pt <- read_excel("IMM_2020.xlsx", sheet = 2)
pob <- pt %>%
group_by(NOM_ENT) %>% #agrupa por estados
summarize(Poblacion_total = sum(POB_TOT, na.rm = TRUE)
#suma las poblaciones de cada municipio, guardandolo el Poblacion_total, y esto lo tendr치 en una fila por estado
)
######츼rea de estados######
mexshp <- st_read("entidades_mex.shp")
estados <- as.data.frame(mexshp)
#Modificamos los nombres de pob para que coincidan en la uni칩n
pob <- pob %>%
#Dentro de pob...
mutate( #...modifica las colmunas.
NOM_ENT = case_when( #En espec칤fico a esta <<En caso de...>>
NOM_ENT== "M칠xico" ~ "Estado de M칠xico",
NOM_ENT == "Michoac치n de Ocampo" ~ "Michoac치n",
NOM_ENT == "Veracruz de Ignacio de la Llave" ~ "Veracruz",
TRUE ~ NOM_ENT
))
#union
union0 <- left_join(estados,pob, by = c ("NOMGEO" = "NOM_ENT"))
######Tabla demogr치fica######
#demo tendr치 s칩lo los estados, su 치rea y poblacipon total
demo <- union0 %>%
select(NOMGEO,area_ha,Poblacion_total)
#Se crea una nuevacolumna de km2
demo <- demo %>%
mutate(km2 = area_ha/100)
#para poder tener la densidad: poblaci칩n/km2 de cada estado.
demo <- demo %>%
mutate(densidad = Poblacion_total/km2)
#Combina las tablas geogr치fica y demogr치fica
mexdens <- mexshp %>%
left_join(demo, by = "NOMGEO")
#Grafica el mapa
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(option = "magma", direction = -1,
name = "Densidad (hab/km)") +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
#Grafica el mapa
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(option = "magma",
name = "Densidad (hab/km)") +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(
option = "magma",
trans = "log",                 # 游댳 transformaci칩n logar칤tmica
name = "Densidad (hab/km)",
breaks = c(10, 100, 1000, 10000), # 游댳 puedes ajustar seg칰n tus datos
labels = c("10", "100", "1,000", "10,000")
) +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
View(mexdens)
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(
option = "magma",
trans = "log",                 # 游댳 transformaci칩n logar칤tmica
name = "Densidad (hab/km)",
breaks = c(10, 100, 1000, 7000), # 游댳 puedes ajustar seg칰n tus datos
labels = c("10", "100", "1,000", "10,000")
) +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(
option = "magma",
trans = "log",                 # 游댳 transformaci칩n logar칤tmica
name = "Densidad (hab/km)",
breaks = c(250, 500, 1000, 7000), # 游댳 puedes ajustar seg칰n tus datos
labels = c("10", "100", "1,000", "10,000")
) +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(
option = "magma",
trans = "log",                 # 游댳 transformaci칩n logar칤tmica
name = "Densidad (hab/km)",
breaks = c(10, 100, 1000, 7000), # 游댳 puedes ajustar seg칰n tus datos
labels = c("10", "100", "1,000", "10,000")
) +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(
option = "magma",
trans = "log",                 # 游댳 transformaci칩n logar칤tmica
name = "Densidad (hab/km)",
breaks = c(10, 100, 1000, 6197), # 游댳 puedes ajustar seg칰n tus datos
labels = c("10", "100", "1,000", "6197")
) +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(
option = "magma",
trans = "log",                 # 游댳 transformaci칩n logar칤tmica
name = "Densidad (hab/km)",
breaks = c(11, 100,200, 1000, 6197), # 游댳 puedes ajustar seg칰n tus datos
labels = c("11", "100","200", "1,000", "6197")
) +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
ggplot(mexdens) +
geom_sf(aes(fill = densidad), color = "black", size = 0.2) +
scale_fill_viridis_c(
option = "magma",
trans = "log",                 # 游댳 transformaci칩n logar칤tmica
name = "Densidad (hab/km)",
breaks = c(11, 50, 200, 700, 6197), # 游댳 puedes ajustar seg칰n tus datos
labels = c("11", "50","200", "700", "6197")
) +
theme_minimal() +
labs(title = "Densidad poblacional por estado (INEGI 2020)",
caption = "Fuente: Censo de Poblaci칩n y Vivienda 2020") +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right")
######Contaminantes por estado######
#Se guarda en cm la informaci칩n que existe en la tabla de mediciones promedio del a침o de contaminantes por municipio tomado en el a침o 2018
cm <- read_csv("contaminantes.csv")
#co es la tabla de los estados de M칠xico y la cantidad promedio de 7 contaminantes en el a침o 2018
co <- cm %>%
#Dentro de cm...
group_by(Entidad_federativa) %>%
#Agrupa por entidades y...
summarize(across(3:9, ~ mean(.x, na.rm = TRUE)
#De las columnas de contaminantes (3:9), crea el promedio de todas las cantidades registras, creando una solo fila para cada estado
))
######Contaminantes por tipo de fuente por estado######
#cpf tiene el promedio de 7 contaminantes por por tipo de fuente de cada estado de M칠xic
cpf <- cm %>%
#Dentro de cm...
group_by(Entidad_federativa, Tipo_de_Fuente) %>%
#... agrupa por Entidad_federativa y Tipo de Fuente, luego...
summarise(across(2:8, ~ mean(.x, na.rm = TRUE)))
#Modificamos
mexshp <- mexshp %>%
#Dentro de pob...
mutate( #...modifica las colmunas.
NOMGEO = case_when( #En espec칤fico a esta <<En caso de...>>
NOMGEO == "Estado de M칠xico" ~ "M칠xico",
NOMGEO  == "Coahuila de Zaragoza" ~ "Coahuila",
TRUE ~ NOMGEO
))
#Creamos una nueva tabla que comnbina los datos de emisiones con la geograf칤a
mexco <- mexshp %>%
left_join(co, by = c("NOMGEO" ="Entidad_federativa"))
ggplot(mexco) +
geom_sf(aes(fill = SO_2 ), color = "white", size = 0.2) +
scale_fill_viridis_c(option = "plasma", name = "Emisi칩n (ton/a침o)") +
theme_minimal() +
labs(title = "Emisiones de CO por estado",
caption = "Inventario Nacional de Emisiones") +
theme(plot.title = element_text(face = "bold", size = 14))
View(co)
View(co)
# Supongamos que "emisiones" tiene estado, CO, NOx, PM10, etc.
pcaco <- co %>%
select(-Entidad_federativa) %>%
scale()  # 游댳 estandariza para que todos los contaminantes pesen igual
pca <- prcomp(pcaco, scale = TRUE)
View(pca)
# Visualizaci칩n
autoplot(pca, data = co, colour = 'Entidad_federativa', label = TRUE, label.size = 3) +
theme_minimal() +
labs(title = "PCA de emisiones por estado",
subtitle = "Agrupaci칩n de estados seg칰n perfil de contaminantes")
View(co)
# Supongamos que "emisiones" tiene estado, CO, NOx, PM10, etc.
pcaco <- co %>%
select(Entidad_federativa) %>%
scale()  # 游댳 estandariza para que todos los contaminantes pesen igual
# Supongamos que "emisiones" tiene estado, CO, NOx, PM10, etc.
pcaco <- co %>%
select(-Entidad_federativa) %>%
scale()  # 游댳 estandariza para que todos los contaminantes pesen igual
pca <- prcomp(pcaco, scale = TRUE)
##########PCA####
library(ggfortify)
# Visualizaci칩n
autoplot(pca, data = co, colour = 'Entidad_federativa', label = TRUE, label.size = 3) +
theme_minimal() +
labs(title = "PCA de emisiones por estado",
subtitle = "Agrupaci칩n de estados seg칰n perfil de contaminantes")
##########PCA####
library(ggfortify)
##########PCA####
install("ggfortify")
##########PCA####
install.packages("ggfortify")
library(ggfortify)
# Visualizaci칩n
autoplot(pca, data = co, colour = 'Entidad_federativa', label = TRUE, label.size = 3) +
theme_minimal() +
labs(title = "PCA de emisiones por estado",
subtitle = "Agrupaci칩n de estados seg칰n perfil de contaminantes")
unique(co$Entidad_federativa)
co$region <- case_when(
co$Entidad_federativa %in% c("Baja California", "Sonora", "Chihuahua", "Durango", "Sinaloa", "Baja California Sur") ~ "Noroeste",
co$Entidad_federativa %in% c("Coahuila", "Nuevo Le칩n", "Tamaulipas") ~ "Noreste",
co$Entidad_federativa %in% c("Nayarit", "Jalisco", "Colima", "Michoac치n") ~ "Occidente",
co$Entidad_federativa %in% c("Zacatecas", "Aguascalientes", "San Luis Potos칤", "Guanajuato") ~ "Baj칤o",
co$Entidad_federativa %in% c("Quer칠taro", "Hidalgo", "Tlaxcala", "Puebla", "Ciudad de M칠xico","M칠xico", "Morelos") ~ "Centro",
co$Entidad_federativa %in% c("Guerrero", "Oaxaca", "Chiapas") ~ "Sur",
co$Entidad_federativa %in% c("Tabasco", "Campeche", "Yucat치n","Quintana Roo","veracruz") ~ "Sureste",
TRUE ~ "Otra"
)
View(co)
co$region <- case_when(
co$Entidad_federativa %in% c("Baja California", "Sonora", "Chihuahua", "Durango", "Sinaloa", "Baja California Sur") ~ "Noroeste",
co$Entidad_federativa %in% c("Coahuila", "Nuevo Le칩n", "Tamaulipas") ~ "Noreste",
co$Entidad_federativa %in% c("Nayarit", "Jalisco", "Colima", "Michoac치n") ~ "Occidente",
co$Entidad_federativa %in% c("Zacatecas", "Aguascalientes", "San Luis Potos칤", "Guanajuato") ~ "Baj칤o",
co$Entidad_federativa %in% c("Quer칠taro", "Hidalgo", "Tlaxcala", "Puebla", "Ciudad de M칠xico","M칠xico", "Morelos") ~ "Centro",
co$Entidad_federativa %in% c("Guerrero", "Oaxaca", "Chiapas") ~ "Sur",
co$Entidad_federativa %in% c("Tabasco", "Campeche", "Yucat치n","Quintana Roo","Veracruz") ~ "Sureste",
TRUE ~ "Otra"
)
View(co)
# Visualizaci칩n
autoplot(pca, data = co, colour = 'region', label = TRUE, label.size = 3) +
theme_minimal() +
labs(title = "PCA de emisiones por estado",
subtitle = "Agrupaci칩n de estados seg칰n perfil de contaminantes")
autoplot(pca, data = co, colour = "region", label = FALSE, frame = TRUE) +
theme_minimal() +
labs(title = "PCA de emisiones por contaminante agrupado por regi칩n") +
scale_color_manual(values = c("Norte" = "#1f78b4",
"Centro" = "#33a02c",
"Sur" = "#e31a1c"))
View(co)
pca_data <- co %>% select(2:8)
pca_result <- prcomp(pca_data, scale. = TRUE)
pca_result <- prcomp(pca_data, scale. = TRUE)
pca_result
autoplot(pca_result,
data = emisiones_estados,
colour = "region",      # colores por regi칩n
label = TRUE,           # mostrar nombre del estado
loadings = TRUE,        # mostrar vectores de contaminantes
loadings.label = TRUE,  # mostrar nombres de contaminantes
loadings.label.size = 3,
loadings.colour = "gray40") +
scale_color_manual(values = c("Norte" = "#1f78b4",
"Centro" = "#33a02c",
"Sur" = "#e31a1c")) +
theme_minimal() +
labs(title = "PCA de emisiones de contaminantes por estado",
subtitle = "Color por regi칩n geogr치fica",
x = "Componente principal 1",
y = "Componente principal 2") +
theme(plot.title = element_text(face = "bold"),
legend.position = "right")
autoplot(pca_result,
data = co,
colour = "region",      # colores por regi칩n
label = TRUE,           # mostrar nombre del estado
loadings = TRUE,        # mostrar vectores de contaminantes
loadings.label = TRUE,  # mostrar nombres de contaminantes
loadings.label.size = 3,
loadings.colour = "gray40") +
scale_color_manual(values = c("Norte" = "#1f78b4",
"Centro" = "#33a02c",
"Sur" = "#e31a1c")) +
theme_minimal() +
labs(title = "PCA de emisiones de contaminantes por estado",
subtitle = "Color por regi칩n geogr치fica",
x = "Componente principal 1",
y = "Componente principal 2") +
theme(plot.title = element_text(face = "bold"),
legend.position = "right")
autoplot(pca_result,
data = co,
colour = "region",      # colores por regi칩n
label = TRUE,           # mostrar nombre del estado
loadings = TRUE,        # mostrar vectores de contaminantes
loadings.label = TRUE,  # mostrar nombres de contaminantes
loadings.label.size = 3,
loadings.colour = "gray40") +
scale_color_manual(values = c("Noroeste" = "red",
"Noreste" = "orange",
"Occidente" = "yellow",
"Baj칤o" = "darkgreen",
"Centro" = "green",
"Sur" = "blue",
"Sureste" = "purple"
)) +
theme_minimal() +
labs(title = "PCA de emisiones de contaminantes por estado",
subtitle = "Color por regi칩n geogr치fica",
x = "Componente principal 1",
y = "Componente principal 2") +
theme(plot.title = element_text(face = "bold"),
legend.position = "right")
summary(pca_result)
pca_result$rotation
plot(pca_result$rotation)
pca_result
#Para el PCA, vamos a usar los datos de las las columnas 2 - 8, que corresponden a los contamiantes
pca_data <- co %>% select(2:8)
#Se guarda el PCA, asegurando que todos tengan una escala cercana para no estar afectados por la variaci칩n
pca_result <- prcomp(pca_data, scale. = TRUE)
summary(pca_result)
autoplot(pca_result,
data = co,
colour = "region",      # colores por regi칩n
label = TRUE,           # mostrar nombre del estado
loadings = TRUE,        # mostrar vectores de contaminantes
loadings.label = TRUE,  # mostrar nombres de contaminantes
loadings.label.size = 3,
loadings.colour = "gray40") +
scale_color_manual(values = c("Noroeste" = "red",
"Noreste" = "orange",
"Occidente" = "yellow",
"Baj칤o" = "darkgreen",
"Centro" = "green",
"Sur" = "blue",
"Sureste" = "purple"
)) +
theme_minimal() +
labs(title = "PCA de emisiones de contaminantes por estado",
subtitle = "Color por regi칩n geogr치fica",
x = "Componente principal 1",
y = "Componente principal 2") +
theme(plot.title = element_text(face = "bold"),
legend.position = "right")
row.names(co) <- co$Entidad_federativa
dn <- co[,-1]
pca <- prcomp(dn,scale. = TRUE)
library(factoextra)
row.names(co) <- co$Entidad_federativa
dn <- co[,-1]
pca <- prcomp(dn,scale. = TRUE)
scale_color_manual(values = c("Noroeste" = "red",
"Noreste" = "orange",
"Occidente" = "yellow",
"Baj칤o" = "darkgreen",
"Centro" = "green",
"Sur" = "blue",
"Sureste" = "purple"
)) +
theme_minimal() +
labs(title = "PCA de emisiones de contaminantes por estado",
subtitle = "Color por regi칩n geogr치fica",
x = "Componente principal 1",
y = "Componente principal 2") +
theme(plot.title = element_text(face = "bold"),
legend.position = "right")
autoplot(pca_result,
data = co,
colour = "region",      # colores por regi칩n
label = TRUE,           # mostrar nombre del estado
loadings = TRUE,        # mostrar vectores de contaminantes
loadings.label = TRUE,  # mostrar nombres de contaminantes
loadings.label.size = 3,
loadings.colour = "gray40",
frame = TRUE,           # <--- agrega los 칩valos de agrupamiento
frame.type = "norm") +
scale_color_manual(values = c("Noroeste" = "red",
"Noreste" = "orange",
"Occidente" = "yellow",
"Baj칤o" = "darkgreen",
"Centro" = "green",
"Sur" = "blue",
"Sureste" = "purple"
)) +
theme_minimal() +
labs(title = "PCA de emisiones de contaminantes por estado",
subtitle = "Color por regi칩n geogr치fica",
x = "Componente principal 1",
y = "Componente principal 2") +
theme(plot.title = element_text(face = "bold"),
legend.position = "right")
#install.packages("ggfortify")
library(ggfortify)
autoplot(pca_result,
data = co,
colour = "region",      # colores por regi칩n
label = TRUE,           # mostrar nombre del estado
loadings = TRUE,        # mostrar vectores de contaminantes
loadings.label = TRUE,  # mostrar nombres de contaminantes
loadings.label.size = 3,
loadings.colour = "gray40",
frame = TRUE,           # <--- agrega los 칩valos de agrupamiento
frame.type = "norm") +
scale_color_manual(values = c("Noroeste" = "red",
"Noreste" = "orange",
"Occidente" = "yellow",
"Baj칤o" = "darkgreen",
"Centro" = "green",
"Sur" = "blue",
"Sureste" = "purple"
)) +
theme_minimal() +
labs(title = "PCA de emisiones de contaminantes por estado",
subtitle = "Color por regi칩n geogr치fica",
x = "Componente principal 1",
y = "Componente principal 2") +
theme(plot.title = element_text(face = "bold"),
legend.position = "right")
